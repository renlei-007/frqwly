(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mine-revise-phone"],{"282f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Throttle=t.Debounce=void 0;var i=function(e,t){var n,i=t||200;return function(){var t=this,o=arguments;n&&clearTimeout(n),n=setTimeout((function(){n=null,e.apply(t,o)}),i)}};t.Debounce=i;var o=function(e,t){var n,i,o=t||1e3;return function(){var t=this,s=arguments,a=+new Date;n&&a-n<o?(clearTimeout(i),i=setTimeout((function(){n=a,e.apply(t,s)}),o)):(n=a,e.apply(this,s))}};t.Throttle=o},3300:function(e,t,n){"use strict";n.r(t);var i=n("4c46"),o=n("dd02");for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("cda6");var a,r=n("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"662ec41e",null,!1,i["a"],a);t["default"]=u.exports},"46ee":function(e,t,n){"use strict";var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("282f"),s=i(n("1a55")),a=i(n("c5c5")),r=(i(n("5364")),i(n("e143")),{data:function(){return{phonenumber:"",code:"",tips:"获取验证码",step:0,timer:null,user_info:{},is_bind:!1}},onLoad:function(){this.user_info=uni.getStorageSync("user_info"),this.user_info.phone&&this.user_info.phone.length>0&&(this.is_bind=!0)},methods:{getphone:function(e){var t=this;console.log(e);var n=e.detail;if("getPhoneNumber:ok"==n.errMsg){var i={appId:"1580387213331704",appKey:"Sd6qkHm9o4LaVluYRX5pUFyNuiu2a8oi",aesKey:"S9u978Q31NGPGc5H",ivKey:"X83yESM9iShLxfwS"},o=n.encryptedData,r=n.iv,u=uni.getStorageSync("session_key"),c=s.default.getRand(),d=this.user_info.id,p=[];p[0]=["session_key",u],p[1]=["encryptedData",o],p[2]=["appId",i.appId],p[3]=["nonce_str",c],p[4]=["iv",r],p[5]=["userId",d];var l=a.default.createSign(p,i.appKey),f={encryptedData:n.encryptedData,iv:n.iv,session_key:u,appId:i.appId,nonce_str:c,sign:l,userId:d};this.request({url:"api/front/user/bindingPhone",data:f,complete:function(e){console.log(e),200==e.code?(t.user_info.phone=e.body.phoneNumber,uni.setStorageSync("user_info",t.copyData(t.user_info)),t.toast("绑定成功！"),setTimeout((function(){uni.navigateBack()}),1500)):357==e.code?t.toast("该手机号已被注册，请使用其他手机号绑定或更改！","none"):t.toast(e.message,"none")}})}},getVerCode:function(){var e=this,t=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;if(11!=this.phonenumber.length||!t.test(this.phonenumber))return uni.showToast({icon:"none",position:"bottom",title:"手机号不正确"}),!1;0==this.step&&this.indexRequest({url:"/sms/send_register_msg",data:{smsSendType:3,mobilePhone:this.phonenumber}}).then((function(t){if(200==t.data.code){e.tips=60;var n=60;e.step=2,e.timer=setInterval((function(){console.log(22222222),n--,e.tips=n,0==n&&(e.tips="重新获取",e.step=1,clearTimeout(e.timer),e.timer=null)}),1e3)}else e.toast(t.data.message,"none")})),1==this.step&&this.indexRequest({url:"/sms/send_register_msg",data:{smsSendType:3,mobilePhone:this.phoneData}}).then((function(t){e.tips=60;var n=60;e.step=2,e.timer=setInterval((function(){console.log(22222222),n--,e.tips=n,0==n&&(e.tips="重新获取",e.step=1,clearTimeout(e.timer),e.timer=null)}),1e3)}))},submit:(0,o.Throttle)((function(){var e=this;console.log(1);var t=/^[1][3,4,5,7,8][0-9]{9}$/;return 11==this.phonenumber.length&&t.test(this.phonenumber)?6!=this.code.length?(this.toast("验证码不正确","none"),!1):void this.homeRequest({url:"/changePhone",methods:"POST",data:{phone:this.phonenumber,validCode:this.code}}).then((function(t){if(200==t.code){e.toast("修改成功！");var n=uni.getStorageSync("user_info");uni.removeStorageSync("user_info"),n.authPhone=e.phonenumber,uni.setStorageSync("user_info",n),setTimeout((function(){uni.navigateBack({delta:1})}),1500)}else e.toast(t.message,"none")})):(this.toast("请输入正确的手机号码","none"),!1)}))}});t.default=r},"4c46":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"content revise-phone"},[n("v-uni-view",{staticClass:"phone inp_box"},[n("v-uni-input",{attrs:{type:"number",placeholder:"请输入手机号码"},model:{value:e.phonenumber,callback:function(t){e.phonenumber=t},expression:"phonenumber"}})],1),n("v-uni-view",{staticClass:"code inp_box"},[n("v-uni-input",{staticClass:"code_inp",attrs:{type:"number",placeholder:"验证码"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),n("v-uni-view",{staticClass:"tips",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getVerCode.apply(void 0,arguments)}}},[e._v(e._s(e.tips))])],1),n("v-uni-view",{staticClass:"submit",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("保存修改")]),e.is_bind?e._e():n("v-uni-button",{staticClass:"submit quick_submit",attrs:{"open-type":"getPhoneNumber",lang:"zh_CN"},on:{getphonenumber:function(t){arguments[0]=t=e.$handleEvent(t),e.getphone.apply(void 0,arguments)}}},[e._v("微信手机号快捷绑定")])],1)},s=[]},9957:function(e,t,n){var i=n("d484");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("4f06").default;o("3fa2be77",i,!0,{sourceMap:!1,shadowMode:!1})},cda6:function(e,t,n){"use strict";var i=n("9957"),o=n.n(i);o.a},d484:function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-page-body[data-v-662ec41e]{background-color:#fff}.content[data-v-662ec41e]{box-sizing:border-box;padding-top:%?40?%}.content .inp_box[data-v-662ec41e]{width:%?690?%;height:%?106?%;background-color:#f2f5fa;border-radius:%?16?%;box-sizing:border-box;padding:0 %?32?%;margin:%?40?% auto 0;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.content .inp_box uni-input[data-v-662ec41e]{width:100%;height:%?40?%;font-size:%?32?%;color:#000}.content .code[data-v-662ec41e]{-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:%?60?%}.content .code .code_inp[data-v-662ec41e]{width:50%}.content .code .tips[data-v-662ec41e]{font-size:%?32?%;color:#6446e1}.content .submit[data-v-662ec41e]{width:%?690?%;height:%?90?%;background:#6446e1;border-radius:%?54?%;line-height:%?90?%;text-align:center;margin:%?80?% auto 0;font-size:%?32?%;color:#fff;opacity:.9}.content .quick_submit[data-v-662ec41e]{margin-top:%?50?%}body.?%PAGE?%[data-v-662ec41e]{background-color:#fff}',""]),e.exports=t},dd02:function(e,t,n){"use strict";n.r(t);var i=n("46ee"),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a}}]);
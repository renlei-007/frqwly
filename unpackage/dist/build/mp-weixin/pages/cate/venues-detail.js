(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cate/venues-detail"],{"005f":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{nowIndex:0,id:"",is_show:!0,content:{seatSetting:{registrationTime:[],time:[]}},venuesList:[],canBooking:!0,comment_show:!1,commentList:[],page:0,isFabulous:!1,is_keep:!1,shareList:[{type:1,icon:"/static/share_wechat.png",text:"微信好友"},{type:2,icon:"/static/share_moment.png",text:"朋友圈"},{type:3,icon:"/static/share_qq.png",text:"QQ好友"},{type:4,icon:"/static/share_qqzone.png",text:"QQ空间"}],channelId:""}},onLoad:function(e){var n=this;if(this.id=e.id,this.channelId=e.channelId,e.scene){console.log(e.scene);var i=decodeURIComponent(e.scene).split("&");2==i.length&&(this.id=i[0],this.channelId=i[1])}this.getDetail(),this.getVenuesList(),this.getCommentList();var o=t.getStorageSync("fabulous"+this.id);o&&(this.isFabulous=!0),this.isLogin&&(this.homeRequest({url:"/view",method:"GET",data:{}}),this.homeRequest({url:"/content/collectExit",method:"GET",data:{cId:this.id}}).then((function(t){"true"==t.body?n.is_keep=!0:n.is_keep=!1})))},methods:{refresh:function(){console.log("刷新"),this.page=0,this.commentList=[],this.getCommentList()},loadMore:function(){console.log("上拉加载"),this.page+=10,this.getCommentList()},close:function(){this.comment_show=!1},share:function(){wx.showShareMenu()},getCommentList:function(){var t=this,e={contentId:this.id,checked:1,first:this.page,count:10};this.indexRequest({url:"/comment/list.jspx",data:e}).then((function(e){var n=e.data.body;t.commentList=t.commentList.concat(n)}))},indexChange:function(t){this.nowIndex=t.detail.current},getDetail:function(){var e=this,n={format:0};179==this.channelId?n.contentId=this.id:n.id=this.id;var i=179==this.channelId?"/bookings/content":(this.channelId,"/content/get.jspx");this.indexRequest({url:i,data:n}).then((function(n){var i=n.data.body;if(i.txt=e.replaceSpecialChar(i.txt),e.content=i,198==e.channelId){var o=(new Date).getTime(),s=new Date(i.seatSetting.registrationTime[1]).getTime();o>s&&(e.canBooking=!1)}t.setNavigationBarTitle({title:i.title})}))},bookings:function(){var e=this;this.isLogin?t.getStorageSync("user_info").isCertification?179==this.channelId?this.homeRequest({url:"/bookings/check_group",method:"GET"}).then((function(n){console.log(n),200==n.code?t.navigateTo({url:"./venues-booking?id="+e.id+"&&channelId="+e.channelId}):e.toast(n.message,"none",1500)})):t.navigateTo({url:"./venues-booking?id="+this.id+"&&channelId="+this.channelId}):this.toast("您还没有实名认证，请先实名认证！","none"):t.showModal({title:"提示",content:"您还没有登录，无法预定，确定先登录吗？",success:function(e){e.confirm?t.navigateTo({url:"/pages/login/login?is_thing=true"}):e.cancel}})},getVenuesList:function(){var t=this,e={count:4,channelIds:this.channelId,sort:4};this.indexRequest({url:"/content/list.jspx",data:e}).then((function(e){console.log(e);var n=e.data.body;t.venuesList=n}))},openMap:function(e){var n=this.bMapToQQMap(e.position.lng,e.position.lat);t.openLocation({latitude:n.lat,longitude:n.lng,name:e.title,address:e.attr_address})},todetail:function(e){t.redirectTo({url:"/pages/cate/venues-detail?id="+e+"&&channelId"+this.channelId})},btnFabulous:function(){var e=this;this.isFabulous?this.indexRequest({url:"/content/down",data:{contentId:this.id}}).then((function(n){200==n.data.code&&(e.isFabulous=!1,t.removeStorageSync("fabulous"+e.id),e.toast("取消点赞成功！"))})):this.indexRequest({url:"/content/up",data:{contentId:this.id}}).then((function(n){200==n.data.code&&(e.isFabulous=!0,t.setStorageSync("fabulous"+e.id,!0),e.toast("点赞成功！"))}))},collection:function(){var e=this;this.isLogin?this.homeRequest({url:"/content/collect",method:"GET",data:{id:this.id,operate:this.is_keep?0:1}}).then((function(t){200==t.code&&(e.is_keep?e.toast("取消收藏成功！"):e.toast("收藏成功！"),e.is_keep=!e.is_keep)})):t.showModal({title:"提示",content:"您还未登录，确定先登录吗？",showCancel:!0,confirmText:"确定",success:function(e){e.confirm?t.navigateTo({url:"/pages/login/login?is_thing="+!0}):e.cancel}})}}};e.default=n}).call(this,n("543d")["default"])},"0493":function(t,e,n){"use strict";n.r(e);var i=n("b9cd"),o=n("1ffd");for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);n("1f76");var a,c=n("f0c5"),u=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=u.exports},"04f1":function(t,e,n){"use strict";(function(t){n("41a1");i(n("66fd"));var e=i(n("0493"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"1adc":function(t,e,n){},"1f76":function(t,e,n){"use strict";var i=n("1adc"),o=n.n(i);o.a},"1ffd":function(t,e,n){"use strict";n.r(e);var i=n("005f"),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=o.a},b9cd:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var i={ysComment:function(){return Promise.all([n.e("common/vendor"),n.e("components/base/ys-comment")]).then(n.bind(null,"eb7c"))},ysShare:function(){return n.e("components/base/ys-share").then(n.bind(null,"4fab"))}},o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.comment_show=!0})},s=[]}},[["04f1","common/runtime","common/vendor"]]]);
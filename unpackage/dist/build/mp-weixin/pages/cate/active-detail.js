(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cate/active-detail"],{3063:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{id:"",is_sign:!1,nowIndex:0,nodes:"",comment:"",content:{},status:0,ticketStatus:0,activeList:[],is_show:!1,comment_show:!1,commentList:[],page:0,isFabulous:!1,is_keep:!1,shareList:[{type:1,icon:"/static/share_wechat.png",text:"微信好友"},{type:2,icon:"/static/share_moment.png",text:"朋友圈"},{type:3,icon:"/static/share_qq.png",text:"QQ好友"},{type:4,icon:"/static/share_qqzone.png",text:"QQ空间"}]}},onLoad:function(e){var n=this;this.id=e.id,this.getDetail(),this.getActiveList(),this.getCommentList();var i=t.getStorageSync("fabulous"+this.id);i&&(this.isFabulous=!0),this.isLogin&&(this.getTicketStatus(),this.homeRequest({url:"/content/collectExit",method:"GET",data:{cId:this.id}}).then((function(t){"true"==t.body?n.is_keep=!0:n.is_keep=!1})))},methods:{refresh:function(){console.log("刷新"),this.page=0,this.commentList=[],this.getCommentList()},loadMore:function(){console.log("上拉加载"),this.page+=10,this.getCommentList()},close:function(){this.comment_show=!1},share:function(){wx.showShareMenu()},getCommentList:function(){var t=this,e={contentId:this.id,checked:1,first:this.page,count:10};this.indexRequest({url:"/comment/list.jspx",data:e}).then((function(e){var n=e.data.body;t.commentList=t.commentList.concat(n)}))},signUp:function(){var e=this;if(this.isLogin){var n=t.getStorageSync("user_info").username;this.homeRequest({url:"/user/get",method:"GET",data:{username:n}}).then((function(n){console.log(n),n.body.isCertification?t.navigateTo({url:"./active-signin?id="+e.id}):e.is_show=!0}))}else t.showModal({title:"提示",content:"您还未登录，确定先登录吗？",showCancel:!0,confirmText:"确定",success:function(e){e.confirm?t.navigateTo({url:"/pages/login/login?is_thing="+!0}):e.cancel}})},toSign:function(){t.navigateTo({url:"../mine/attestation"})},getDetail:function(){var e=this,n={format:0,id:this.id};this.indexRequest({url:"/content/get.jspx",data:n}).then((function(n){console.log(n);var i=n.data.body;e.content=i,e.ticketStatus=n.data.body.ticketingSetting.status,t.setNavigationBarTitle({title:i.title})}))},getTicketStatus:function(){var t=this;this.homeRequest({url:"/ticket/status",method:"GET",data:{contentId:this.id}}).then((function(e){200==e.code&&(t.status=e.body.status)}))},getActiveList:function(){var t=this,e={count:5,channelIds:"116",sort:4};this.indexRequest({url:"/content/list.jspx",data:e}).then((function(e){console.log(e);var n=e.data.body;n.shift(),t.activeList=n}))},dateFormat:function(t){if(t&&t.ticketingSetting&&t.ticketingSetting.registrationStart){var e=t.ticketingSetting.registrationStart?t.ticketingSetting.registrationStart.substring(0,10):"",n=t.ticketingSetting.registrationEnd?t.ticketingSetting.registrationEnd.substring(0,10):"";return e+"-"+n}return"暂无"},todetail:function(e){t.redirectTo({url:"/pages/cate/active-detail?id="+e})},openMap:function(e){var n=this.bMapToQQMap(e.position.lng,e.position.lat);t.openLocation({latitude:n.lat,longitude:n.lng,name:e.title,address:e.attr_address})},btnFabulous:function(){var e=this;this.isFabulous?this.indexRequest({url:"/content/down",data:{contentId:this.id}}).then((function(n){200==n.data.code&&(e.isFabulous=!1,t.removeStorageSync("fabulous"+e.id),e.toast("取消点赞成功！"))})):this.indexRequest({url:"/content/up",data:{contentId:this.id}}).then((function(n){200==n.data.code&&(e.isFabulous=!0,t.setStorageSync("fabulous"+e.id,!0),e.toast("点赞成功！"))}))},collection:function(){var e=this;this.isLogin?this.homeRequest({url:"/content/collect",method:"GET",data:{id:this.id,operate:this.is_keep?0:1}}).then((function(t){200==t.code&&(e.is_keep?e.toast("取消收藏成功！"):e.toast("收藏成功！"),e.is_keep=!e.is_keep)})):t.showModal({title:"提示",content:"您还未登录，确定先登录吗？",showCancel:!0,confirmText:"确定",success:function(e){e.confirm?t.navigateTo({url:"/pages/login/login?is_thing="+!0}):e.cancel}})}}};e.default=n}).call(this,n("543d")["default"])},4164:function(t,e,n){"use strict";var i=n("fce5"),o=n.n(i);o.a},6072:function(t,e,n){"use strict";n.r(e);var i=n("f040"),o=n("9f79");for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);n("4164");var a,c=n("f0c5"),u=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=u.exports},"9f79":function(t,e,n){"use strict";n.r(e);var i=n("3063"),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=o.a},bd16:function(t,e,n){"use strict";(function(t){n("41a1");i(n("66fd"));var e=i(n("6072"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},f040:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var i={ysComment:function(){return Promise.all([n.e("common/vendor"),n.e("components/base/ys-comment")]).then(n.bind(null,"eb7c"))},ysShare:function(){return n.e("components/base/ys-share").then(n.bind(null,"4fab"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.dateFormat(t.content));t._isMounted||(t.e0=function(e){t.comment_show=!0},t.e1=function(e){t.is_sign=!1},t.e2=function(e){t.is_show=!1}),t.$mp.data=Object.assign({},{$root:{m0:n}})},s=[]},fce5:function(t,e,n){}},[["bd16","common/runtime","common/vendor"]]]);